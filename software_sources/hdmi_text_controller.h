#ifndef HDMI_TEXT_CONTROLLER_H
#define HDMI_TEXT_CONTROLLER_H


/****************** Include Files ********************/
#include "xil_types.h"
#include "xstatus.h"
#include "xparameters.h"

#define COLUMNS 80
#define ROWS 30
#define PALETTE_START 0x2000

// #define STUDENT1NETID "<student1>"
// #define STUDENT2NETID "<student2>"

struct TEXT_HDMI_STRUCT {
	uint8_t             VRAM [ROWS*COLUMNS*2]; //Week 2 - extended VRAM
	uint8_t             padding[PALETTE_START - ROWS * COLUMNS * 2];
	uint32_t            palette[256];
	uint32_t            FRAME_COUNT; //control registers should appear immediately after palette
	uint32_t            DRAWX;
	uint32_t            DRAWY;
};

struct COLOR{
	char name [20];
	uint8_t red;
	uint8_t green;
	uint8_t blue;
};


//you may have to change this line depending on your platform designer
static volatile struct TEXT_HDMI_STRUCT* hdmi_ctrl = XPAR_HDMI_TEXT_CONTROLLER_0_AXI_BASEADDR;

//CGA colors with names
struct COLOR {
    const char *name;
    unsigned char r;
    unsigned char g;
    unsigned char b;
};

static struct COLOR pallete[256] = {
    {"R0_G0_B0", 0x0, 0x0, 0x0},
    {"R0_G0_B1", 0x0, 0x0, 0x1},
    {"R0_G0_B2", 0x0, 0x0, 0x2},
    {"R0_G0_B3", 0x0, 0x0, 0x3},
    {"R0_G0_B4", 0x0, 0x0, 0x4},
    {"R0_G0_B5", 0x0, 0x0, 0x5},
    {"R0_G0_B6", 0x0, 0x0, 0x6},
    {"R0_G0_B7", 0x0, 0x0, 0x7},
    {"R0_G0_B8", 0x0, 0x0, 0x8},
    {"R0_G0_B9", 0x0, 0x0, 0x9},
    {"R0_G0_BA", 0x0, 0x0, 0xA},
    {"R0_G0_BB", 0x0, 0x0, 0xB},
    {"R0_G0_BC", 0x0, 0x0, 0xC},
    {"R0_G0_BD", 0x0, 0x0, 0xD},
    {"R0_G0_BE", 0x0, 0x0, 0xE},
    {"R0_G0_BF", 0x0, 0x0, 0xF},
    {"R0_G1_B0", 0x0, 0x1, 0x0},
    {"R0_G1_B1", 0x0, 0x1, 0x1},
    {"R0_G1_B2", 0x0, 0x1, 0x2},
    {"R0_G1_B3", 0x0, 0x1, 0x3},
    {"R0_G1_B4", 0x0, 0x1, 0x4},
    {"R0_G1_B5", 0x0, 0x1, 0x5},
    {"R0_G1_B6", 0x0, 0x1, 0x6},
    {"R0_G1_B7", 0x0, 0x1, 0x7},
    {"R0_G1_B8", 0x0, 0x1, 0x8},
    {"R0_G1_B9", 0x0, 0x1, 0x9},
    {"R0_G1_BA", 0x0, 0x1, 0xA},
    {"R0_G1_BB", 0x0, 0x1, 0xB},
    {"R0_G1_BC", 0x0, 0x1, 0xC},
    {"R0_G1_BD", 0x0, 0x1, 0xD},
    {"R0_G1_BE", 0x0, 0x1, 0xE},
    {"R0_G1_BF", 0x0, 0x1, 0xF},
    {"R0_G2_B0", 0x0, 0x2, 0x0},
    {"R0_G2_B1", 0x0, 0x2, 0x1},
    {"R0_G2_B2", 0x0, 0x2, 0x2},
    {"R0_G2_B3", 0x0, 0x2, 0x3},
    {"R0_G2_B4", 0x0, 0x2, 0x4},
    {"R0_G2_B5", 0x0, 0x2, 0x5},
    {"R0_G2_B6", 0x0, 0x2, 0x6},
    {"R0_G2_B7", 0x0, 0x2, 0x7},
    {"R0_G2_B8", 0x0, 0x2, 0x8},
    {"R0_G2_B9", 0x0, 0x2, 0x9},
    {"R0_G2_BA", 0x0, 0x2, 0xA},
    {"R0_G2_BB", 0x0, 0x2, 0xB},
    {"R0_G2_BC", 0x0, 0x2, 0xC},
    {"R0_G2_BD", 0x0, 0x2, 0xD},
    {"R0_G2_BE", 0x0, 0x2, 0xE},
    {"R0_G2_BF", 0x0, 0x2, 0xF},
    {"R0_G3_B0", 0x0, 0x3, 0x0},
    {"R0_G3_B1", 0x0, 0x3, 0x1},
    {"R0_G3_B2", 0x0, 0x3, 0x2},
    {"R0_G3_B3", 0x0, 0x3, 0x3},
    {"R0_G3_B4", 0x0, 0x3, 0x4},
    {"R0_G3_B5", 0x0, 0x3, 0x5},
    {"R0_G3_B6", 0x0, 0x3, 0x6},
    {"R0_G3_B7", 0x0, 0x3, 0x7},
    {"R0_G3_B8", 0x0, 0x3, 0x8},
    {"R0_G3_B9", 0x0, 0x3, 0x9},
    {"R0_G3_BA", 0x0, 0x3, 0xA},
    {"R0_G3_BB", 0x0, 0x3, 0xB},
    {"R0_G3_BC", 0x0, 0x3, 0xC},
    {"R0_G3_BD", 0x0, 0x3, 0xD},
    {"R0_G3_BE", 0x0, 0x3, 0xE},
    {"R0_G3_BF", 0x0, 0x3, 0xF},
    {"R0_G4_B0", 0x0, 0x4, 0x0},
    {"R0_G4_B1", 0x0, 0x4, 0x1},
    {"R0_G4_B2", 0x0, 0x4, 0x2},
    {"R0_G4_B3", 0x0, 0x4, 0x3},
    {"R0_G4_B4", 0x0, 0x4, 0x4},
    {"R0_G4_B5", 0x0, 0x4, 0x5},
    {"R0_G4_B6", 0x0, 0x4, 0x6},
    {"R0_G4_B7", 0x0, 0x4, 0x7},
    {"R0_G4_B8", 0x0, 0x4, 0x8},
    {"R0_G4_B9", 0x0, 0x4, 0x9},
    {"R0_G4_BA", 0x0, 0x4, 0xA},
    {"R0_G4_BB", 0x0, 0x4, 0xB},
    {"R0_G4_BC", 0x0, 0x4, 0xC},
    {"R0_G4_BD", 0x0, 0x4, 0xD},
    {"R0_G4_BE", 0x0, 0x4, 0xE},
    {"R0_G4_BF", 0x0, 0x4, 0xF},
    {"R0_G5_B0", 0x0, 0x5, 0x0},
    {"R0_G5_B1", 0x0, 0x5, 0x1},
    {"R0_G5_B2", 0x0, 0x5, 0x2},
    {"R0_G5_B3", 0x0, 0x5, 0x3},
    {"R0_G5_B4", 0x0, 0x5, 0x4},
    {"R0_G5_B5", 0x0, 0x5, 0x5},
    {"R0_G5_B6", 0x0, 0x5, 0x6},
    {"R0_G5_B7", 0x0, 0x5, 0x7},
    {"R0_G5_B8", 0x0, 0x5, 0x8},
    {"R0_G5_B9", 0x0, 0x5, 0x9},
    {"R0_G5_BA", 0x0, 0x5, 0xA},
    {"R0_G5_BB", 0x0, 0x5, 0xB},
    {"R0_G5_BC", 0x0, 0x5, 0xC},
    {"R0_G5_BD", 0x0, 0x5, 0xD},
    {"R0_G5_BE", 0x0, 0x5, 0xE},
    {"R0_G5_BF", 0x0, 0x5, 0xF},
    {"R0_G6_B0", 0x0, 0x6, 0x0},
    {"R0_G6_B1", 0x0, 0x6, 0x1},
    {"R0_G6_B2", 0x0, 0x6, 0x2},
    {"R0_G6_B3", 0x0, 0x6, 0x3},
    {"R0_G6_B4", 0x0, 0x6, 0x4},
    {"R0_G6_B5", 0x0, 0x6, 0x5},
    {"R0_G6_B6", 0x0, 0x6, 0x6},
    {"R0_G6_B7", 0x0, 0x6, 0x7},
    {"R0_G6_B8", 0x0, 0x6, 0x8},
    {"R0_G6_B9", 0x0, 0x6, 0x9},
    {"R0_G6_BA", 0x0, 0x6, 0xA},
    {"R0_G6_BB", 0x0, 0x6, 0xB},
    {"R0_G6_BC", 0x0, 0x6, 0xC},
    {"R0_G6_BD", 0x0, 0x6, 0xD},
    {"R0_G6_BE", 0x0, 0x6, 0xE},
    {"R0_G6_BF", 0x0, 0x6, 0xF},
    {"R0_G7_B0", 0x0, 0x7, 0x0},
    {"R0_G7_B1", 0x0, 0x7, 0x1},
    {"R0_G7_B2", 0x0, 0x7, 0x2},
    {"R0_G7_B3", 0x0, 0x7, 0x3},
    {"R0_G7_B4", 0x0, 0x7, 0x4},
    {"R0_G7_B5", 0x0, 0x7, 0x5},
    {"R0_G7_B6", 0x0, 0x7, 0x6},
    {"R0_G7_B7", 0x0, 0x7, 0x7},
    {"R0_G7_B8", 0x0, 0x7, 0x8},
    {"R0_G7_B9", 0x0, 0x7, 0x9},
    {"R0_G7_BA", 0x0, 0x7, 0xA},
    {"R0_G7_BB", 0x0, 0x7, 0xB},
    {"R0_G7_BC", 0x0, 0x7, 0xC},
    {"R0_G7_BD", 0x0, 0x7, 0xD},
    {"R0_G7_BE", 0x0, 0x7, 0xE},
    {"R0_G7_BF", 0x0, 0x7, 0xF},
    {"R0_G8_B0", 0x0, 0x8, 0x0},
    {"R0_G8_B1", 0x0, 0x8, 0x1},
    {"R0_G8_B2", 0x0, 0x8, 0x2},
    {"R0_G8_B3", 0x0, 0x8, 0x3},
    {"R0_G8_B4", 0x0, 0x8, 0x4},
    {"R0_G8_B5", 0x0, 0x8, 0x5},
    {"R0_G8_B6", 0x0, 0x8, 0x6},
    {"R0_G8_B7", 0x0, 0x8, 0x7},
    {"R0_G8_B8", 0x0, 0x8, 0x8},
    {"R0_G8_B9", 0x0, 0x8, 0x9},
    {"R0_G8_BA", 0x0, 0x8, 0xA},
    {"R0_G8_BB", 0x0, 0x8, 0xB},
    {"R0_G8_BC", 0x0, 0x8, 0xC},
    {"R0_G8_BD", 0x0, 0x8, 0xD},
    {"R0_G8_BE", 0x0, 0x8, 0xE},
    {"R0_G8_BF", 0x0, 0x8, 0xF},
    {"R0_G9_B0", 0x0, 0x9, 0x0},
    {"R0_G9_B1", 0x0, 0x9, 0x1},
    {"R0_G9_B2", 0x0, 0x9, 0x2},
    {"R0_G9_B3", 0x0, 0x9, 0x3},
    {"R0_G9_B4", 0x0, 0x9, 0x4},
    {"R0_G9_B5", 0x0, 0x9, 0x5},
    {"R0_G9_B6", 0x0, 0x9, 0x6},
    {"R0_G9_B7", 0x0, 0x9, 0x7},
    {"R0_G9_B8", 0x0, 0x9, 0x8},
    {"R0_G9_B9", 0x0, 0x9, 0x9},
    {"R0_G9_BA", 0x0, 0x9, 0xA},
    {"R0_G9_BB", 0x0, 0x9, 0xB},
    {"R0_G9_BC", 0x0, 0x9, 0xC},
    {"R0_G9_BD", 0x0, 0x9, 0xD},
    {"R0_G9_BE", 0x0, 0x9, 0xE},
    {"R0_G9_BF", 0x0, 0x9, 0xF},
    {"R0_GA_B0", 0x0, 0xA, 0x0},
    {"R0_GA_B1", 0x0, 0xA, 0x1},
    {"R0_GA_B2", 0x0, 0xA, 0x2},
    {"R0_GA_B3", 0x0, 0xA, 0x3},
    {"R0_GA_B4", 0x0, 0xA, 0x4},
    {"R0_GA_B5", 0x0, 0xA, 0x5},
    {"R0_GA_B6", 0x0, 0xA, 0x6},
    {"R0_GA_B7", 0x0, 0xA, 0x7},
    {"R0_GA_B8", 0x0, 0xA, 0x8},
    {"R0_GA_B9", 0x0, 0xA, 0x9},
    {"R0_GA_BA", 0x0, 0xA, 0xA},
    {"R0_GA_BB", 0x0, 0xA, 0xB},
    {"R0_GA_BC", 0x0, 0xA, 0xC},
    {"R0_GA_BD", 0x0, 0xA, 0xD},
    {"R0_GA_BE", 0x0, 0xA, 0xE},
    {"R0_GA_BF", 0x0, 0xA, 0xF},
    {"R0_GB_B0", 0x0, 0xB, 0x0},
    {"R0_GB_B1", 0x0, 0xB, 0x1},
    {"R0_GB_B2", 0x0, 0xB, 0x2},
    {"R0_GB_B3", 0x0, 0xB, 0x3},
    {"R0_GB_B4", 0x0, 0xB, 0x4},
    {"R0_GB_B5", 0x0, 0xB, 0x5},
    {"R0_GB_B6", 0x0, 0xB, 0x6},
    {"R0_GB_B7", 0x0, 0xB, 0x7},
    {"R0_GB_B8", 0x0, 0xB, 0x8},
    {"R0_GB_B9", 0x0, 0xB, 0x9},
    {"R0_GB_BA", 0x0, 0xB, 0xA},
    {"R0_GB_BB", 0x0, 0xB, 0xB},
    {"R0_GB_BC", 0x0, 0xB, 0xC},
    {"R0_GB_BD", 0x0, 0xB, 0xD},
    {"R0_GB_BE", 0x0, 0xB, 0xE},
    {"R0_GB_BF", 0x0, 0xB, 0xF},
    {"R0_GC_B0", 0x0, 0xC, 0x0},
    {"R0_GC_B1", 0x0, 0xC, 0x1},
    {"R0_GC_B2", 0x0, 0xC, 0x2},
    {"R0_GC_B3", 0x0, 0xC, 0x3},
    {"R0_GC_B4", 0x0, 0xC, 0x4},
    {"R0_GC_B5", 0x0, 0xC, 0x5},
    {"R0_GC_B6", 0x0, 0xC, 0x6},
    {"R0_GC_B7", 0x0, 0xC, 0x7},
    {"R0_GC_B8", 0x0, 0xC, 0x8},
    {"R0_GC_B9", 0x0, 0xC, 0x9},
    {"R0_GC_BA", 0x0, 0xC, 0xA},
    {"R0_GC_BB", 0x0, 0xC, 0xB},
    {"R0_GC_BC", 0x0, 0xC, 0xC},
    {"R0_GC_BD", 0x0, 0xC, 0xD},
    {"R0_GC_BE", 0x0, 0xC, 0xE},
    {"R0_GC_BF", 0x0, 0xC, 0xF},
    {"R0_GD_B0", 0x0, 0xD, 0x0},
    {"R0_GD_B1", 0x0, 0xD, 0x1},
    {"R0_GD_B2", 0x0, 0xD, 0x2},
    {"R0_GD_B3", 0x0, 0xD, 0x3},
    {"R0_GD_B4", 0x0, 0xD, 0x4},
    {"R0_GD_B5", 0x0, 0xD, 0x5},
    {"R0_GD_B6", 0x0, 0xD, 0x6},
    {"R0_GD_B7", 0x0, 0xD, 0x7},
    {"R0_GD_B8", 0x0, 0xD, 0x8},
    {"R0_GD_B9", 0x0, 0xD, 0x9},
    {"R0_GD_BA", 0x0, 0xD, 0xA},
    {"R0_GD_BB", 0x0, 0xD, 0xB},
    {"R0_GD_BC", 0x0, 0xD, 0xC},
    {"R0_GD_BD", 0x0, 0xD, 0xD},
    {"R0_GD_BE", 0x0, 0xD, 0xE},
    {"R0_GD_BF", 0x0, 0xD, 0xF},
    {"R0_GE_B0", 0x0, 0xE, 0x0},
    {"R0_GE_B1", 0x0, 0xE, 0x1},
    {"R0_GE_B2", 0x0, 0xE, 0x2},
    {"R0_GE_B3", 0x0, 0xE, 0x3},
    {"R0_GE_B4", 0x0, 0xE, 0x4},
    {"R0_GE_B5", 0x0, 0xE, 0x5},
    {"R0_GE_B6", 0x0, 0xE, 0x6},
    {"R0_GE_B7", 0x0, 0xE, 0x7},
    {"R0_GE_B8", 0x0, 0xE, 0x8},
    {"R0_GE_B9", 0x0, 0xE, 0x9},
    {"R0_GE_BA", 0x0, 0xE, 0xA},
    {"R0_GE_BB", 0x0, 0xE, 0xB},
    {"R0_GE_BC", 0x0, 0xE, 0xC},
    {"R0_GE_BD", 0x0, 0xE, 0xD},
    {"R0_GE_BE", 0x0, 0xE, 0xE},
    {"R0_GE_BF", 0x0, 0xE, 0xF},
    {"R0_GF_B0", 0x0, 0xF, 0x0},
    {"R0_GF_B1", 0x0, 0xF, 0x1},
    {"R0_GF_B2", 0x0, 0xF, 0x2},
    {"R0_GF_B3", 0x0, 0xF, 0x3},
    {"R0_GF_B4", 0x0, 0xF, 0x4},
    {"R0_GF_B5", 0x0, 0xF, 0x5},
    {"R0_GF_B6", 0x0, 0xF, 0x6},
    {"R0_GF_B7", 0x0, 0xF, 0x7},
    {"R0_GF_B8", 0x0, 0xF, 0x8},
    {"R0_GF_B9", 0x0, 0xF, 0x9},
    {"R0_GF_BA", 0x0, 0xF, 0xA},
    {"R0_GF_BB", 0x0, 0xF, 0xB},
    {"R0_GF_BC", 0x0, 0xF, 0xC},
    {"R0_GF_BD", 0x0, 0xF, 0xD},
    {"R0_GF_BE", 0x0, 0xF, 0xE},
    {"R0_GF_BF", 0x0, 0xF, 0xF}
};


/**************************** Type Definitions *****************************/
/**
 *
 * Write a value to a HDMI_TEXT_CONTROLLER register. A 32 bit write is performed.
 * If the component is implemented in a smaller width, only the least
 * significant data is written.
 *
 * @param   BaseAddress is the base address of the HDMI_TEXT_CONTROLLERdevice.
 * @param   RegOffset is the register offset from the base to write to.
 * @param   Data is the data written to the register.
 *
 * @return  None.
 *
 * @note
 * C-style signature:
 * 	void HDMI_TEXT_CONTROLLER_mWriteReg(u32 BaseAddress, unsigned RegOffset, u32 Data)
 *
 */
#define HDMI_TEXT_CONTROLLER_mWriteReg(BaseAddress, RegOffset, Data) \
  	Xil_Out32((BaseAddress) + (RegOffset), (u32)(Data))

/**
 *
 * Read a value from a HDMI_TEXT_CONTROLLER register. A 32 bit read is performed.
 * If the component is implemented in a smaller width, only the least
 * significant data is read from the register. The most significant data
 * will be read as 0.
 *
 * @param   BaseAddress is the base address of the HDMI_TEXT_CONTROLLER device.
 * @param   RegOffset is the register offset from the base to write to.
 *
 * @return  Data is the data from the register.
 *
 * @note
 * C-style signature:
 * 	u32 HDMI_TEXT_CONTROLLER_mReadReg(u32 BaseAddress, unsigned RegOffset)
 *
 */
#define HDMI_TEXT_CONTROLLER_mReadReg(BaseAddress, RegOffset) \
    Xil_In32((BaseAddress) + (RegOffset))

/************************** Function Prototypes ****************************/
/**
 *
 * Run a self-test on the driver/device. Note this may be a destructive test if
 * resets of the device are performed.
 *
 * If the hardware system is not built correctly, this function may never
 * return to the caller.
 *
 * @param   baseaddr_p is the base address of the HDMI_TEXT_CONTROLLER instance to be worked on.
 *
 * @return
 *
 *    - XST_SUCCESS   if all self-test code passed
 *    - XST_FAILURE   if any self-test code failed
 *
 * @note    Caching must be turned off for this function to work.
 * @note    Self test may fail if data memory and device are not on the same bus.
 *
 */
 

void textHDMIColorClr();
void textHDMIDrawColorText(char* str, int x, int y, uint8_t background, uint8_t foreground);
void setColorPalette (uint8_t color, uint8_t red, uint8_t green, uint8_t blue); //Fill in this code
void sleepframe(uint32_t frames);
void paletteTest();
void textHDMIColorScreenSaver();
void hdmiTestWeek2(); //call this for your Week 2 demo


typedef struct { float x, y, z; float u, v; } Vertex;

//Implement the ear clipping algorithm
int triangulate(Vertex* polygon);

#endif // HDMI_TEXT_CONTROLLER_H